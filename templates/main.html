<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link href="https://cdn.bootcdn.net/ajax/libs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet" />
    <script src="https://cdn.bootcdn.net/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script>
    <script src="https://cdn.staticfile.org/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="../static/chessboard/js/chessboard-1.0.0.min.js"></script>
    <link href="../static/chessboard/css/chessboard-1.0.0.min.css" rel="stylesheet" />
</head>
<script>
    $(document).ready(function () {
        $.get("./api/board", function (data) {
            let config = {
                pieceTheme: "../static/chessboard/img/chesspieces/wikipedia/{piece}.png",
                position: data.FEN
            };
            var board = Chessboard('board', config);
            $("#info").text(`${data.turn} to move. Make your choice`);
        })
        $("#vote").click(function () {
            let move = $("#move").val();
            $.get("./api/legal", data = { move: move }, function (data) {
                if (data == "-1") {
                    $("#moveinput").attr("class", "ui action input error");
                    setTimeout(function () {
                        $("#moveinput").attr("class", "ui action input");
                        $("#move").val("")
                    }, 500)
                }
            });
        })
        $("#login").click(function(){
            $.cookie('username', $("#username").val(), { expires: 365 });
            $.cookie('password', $("#password").val(), { expires: 365 });
            $("#login").attr("class", "ui positive button");
            setTimeout(function () {
                $("#login").attr("class", "ui button");
            }, 500)
        })
    });
</script>

<body>
    <div id="board" style="width: 400px"></div>
    <p id="info"></p>
    <div class="ui action input" id="moveinput">
        <input type="text" id="move">
        <button class="ui button" id="vote">Vote!</button>
    </div>
    <div>
        <div class="ui input">
            <input type="text" placeholder="Username" id="username">
        </div>
        <div class="ui input">
            <input type="text" placeholder="Password" id="password">
        </div>
        <button class="ui button" id="login">
            Login
        </button>
    </div>
</body>